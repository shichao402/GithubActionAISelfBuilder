---
alwaysApply: true
---
# Git 推送规范 - 项目特定规则

> **注意**: 此规则文件仅适用于本项目，已添加到 .gitignore，不会提交到仓库。

## 🚨 核心规则

**AI 助手在推送代码到远程仓库时，必须且只能使用项目提供的一键推送脚本，禁止直接使用 `git push` 命令。**

## 📋 可用脚本

### 1. TypeScript 脚本（推荐，跨平台）

```bash
# 使用 npm 脚本
npm run push [提交信息]

# 或直接使用 ts-node
ts-node scripts/push-git.ts [提交信息]
```

### 2. PowerShell 脚本（Windows）

```powershell
.\scripts\push-git.ps1 [提交信息]
```

### 3. Shell 脚本（Linux/Mac）

```bash
./scripts/push-git.sh [提交信息]
```

## 🎯 脚本功能

一键推送脚本会自动执行以下操作：

1. **检查更改**: 自动检测是否有未提交的更改
2. **显示状态**: 显示当前 Git 状态
3. **添加更改**: 自动添加所有更改 (`git add -A`)
4. **智能提交**: 
   - 如果提供了提交信息，使用提供的信息
   - 如果没有提供，自动生成带时间戳的默认信息：`chore: update for testing GitHub Actions [时间戳]`
5. **推送代码**: 推送到远程仓库的当前分支
6. **错误处理**: 完善的错误处理和提示信息

## 📝 使用示例

### 示例 1: 使用默认提交信息

```bash
npm run push
```

生成的提交信息示例：
```
chore: update for testing GitHub Actions [2024-01-15 14:30:25]
```

### 示例 2: 使用自定义提交信息

```bash
npm run push "fix: update workflow configuration"
```

### 示例 3: 测试 GitHub Actions

```bash
npm run push "test: trigger workflow for testing"
```

### 示例 4: 功能开发提交

```bash
npm run push "feat: add new pipeline support"
```

## ⚠️ 禁止的操作

以下操作**严格禁止**：

- ❌ 直接使用 `git push` 命令
- ❌ 手动执行 `git add` + `git commit` + `git push`
- ❌ 使用其他 Git 推送工具或脚本
- ❌ 跳过提交直接推送

## ✅ 为什么必须使用脚本

1. **自动化流程**: 确保推送前自动添加和提交所有更改
2. **状态反馈**: 提供清晰的执行状态反馈
3. **统一格式**: 统一的提交信息格式，便于追踪
4. **错误处理**: 完善的错误处理和提示
5. **测试便利**: 方便持续测试 GitHub Actions
6. **避免遗漏**: 避免忘记添加或提交文件

## 🔧 脚本位置

所有推送脚本位于 `scripts/` 目录：

- `scripts/push-git.ts` - TypeScript 脚本（跨平台）
- `scripts/push-git.ps1` - PowerShell 脚本（Windows）
- `scripts/push-git.sh` - Shell 脚本（Linux/Mac）

## 📚 相关文档

详细使用说明请参考：`scripts/README-push-git.md`

## 🐛 故障排除

### 问题 1: 推送失败，提示远程分支不存在

**解决方案**:
```bash
git push -u origin <当前分支名>
```

### 问题 2: PowerShell 脚本无法执行

**解决方案**:
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### 问题 3: Shell 脚本提示权限不足

**解决方案**:
```bash
chmod +x scripts/push-git.sh
```

### 问题 4: 没有配置远程仓库

**解决方案**:
```bash
git remote add origin <远程仓库URL>
```

## 🎯 AI 助手行为要求

当 AI 助手需要推送代码时，必须：

1. ✅ 使用 `npm run push [提交信息]` 或对应的脚本
2. ✅ 提供有意义的提交信息（如果适用）
3. ✅ 检查推送结果，确保成功
4. ✅ 如果推送失败，根据错误信息提供解决方案

**绝对禁止**：
- ❌ 直接使用 `git push` 命令
- ❌ 手动执行 Git 命令序列
- ❌ 跳过推送步骤

## 📌 规则优先级

此规则具有**最高优先级**，所有其他规则都必须遵守此规则。即使在其他规则中提到了 Git 操作，也必须使用项目提供的一键推送脚本。
