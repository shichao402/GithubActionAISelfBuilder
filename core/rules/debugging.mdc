---
alwaysApply: true
---

# GitHub Actions è°ƒè¯•è§„åˆ™

## ğŸš¨ æ ¸å¿ƒè§„åˆ™

**AI åŠ©æ‰‹åœ¨è°ƒè¯• GitHub Actions æ—¶å¿…é¡»éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š**

1. **å¿…é¡»ä½¿ç”¨å·¥å…·è„šæœ¬**ï¼šä¸¥æ ¼ç¦æ­¢æ‰‹åŠ¨è¿è¡Œ `gh workflow run` å‘½ä»¤
2. **å¿…é¡»å…ˆæ¨é€ä»£ç **ï¼šåœ¨çº¿æµ‹è¯•å‰å¿…é¡»æ¨é€ä»£ç åˆ°è¿œç¨‹ä»“åº“
3. **å¿…é¡»æ”¶é›†æ—¥å¿—**ï¼šå¤±è´¥æ—¶å¿…é¡»æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼Œä¸èƒ½çŒœæµ‹
4. **å¿…é¡»éªŒè¯ä¿®å¤**ï¼šä¿®å¤åå¿…é¡»é‡æ–°æµ‹è¯•éªŒè¯

## ğŸ“‹ æ ‡å‡†è°ƒè¯•æµç¨‹

### å®Œæ•´çš„è°ƒè¯•å¾ªç¯

```bash
# 1. ä¿®å¤ä»£ç æˆ–å·¥ä½œæµ
vim .github/workflows/build.yml

# 2. æ¨é€ä»£ç åˆ°è¿œç¨‹ä»“åº“ï¼ˆå¿…é¡»ï¼ï¼‰
git add .github/workflows/build.yml
git commit -m "fix: ä¿®å¤å·¥ä½œæµé—®é¢˜"
git push origin main

# 3. ä½¿ç”¨è°ƒè¯•è„šæœ¬è§¦å‘å¹¶ç›‘æ§
npm run ai-debug -- .github/workflows/build.yml main

# 4. è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
#    - è§¦å‘å·¥ä½œæµ
#    - ç›‘æ§æ‰§è¡ŒçŠ¶æ€
#    - æ”¶é›†å¤±è´¥æ—¥å¿—
#    - åˆ†æé”™è¯¯åŸå› 
#    - æä¾›ä¿®å¤å»ºè®®

# 5. æ ¹æ®å»ºè®®ä¿®å¤ä»£ç 

# 6. é‡å¤æ­¥éª¤ 1-5 ç›´åˆ°æˆåŠŸ
```

### ä¸ºä»€ä¹ˆå¿…é¡»å…ˆæ¨é€ä»£ç ï¼Ÿ

```
âŒ é”™è¯¯æµç¨‹ï¼š
1. ä¿®æ”¹æœ¬åœ°æ–‡ä»¶
2. è§¦å‘ workflow  â† GitHub ä½¿ç”¨æ—§ä»£ç ï¼
3. æµ‹è¯•å¤±è´¥      â† ä½†æœ¬åœ°å·²ç»ä¿®å¤äº†

âœ… æ­£ç¡®æµç¨‹ï¼š
1. ä¿®æ”¹æœ¬åœ°æ–‡ä»¶
2. æ¨é€åˆ°è¿œç¨‹ä»“åº“
3. è§¦å‘ workflow  â† GitHub ä½¿ç”¨æ–°ä»£ç 
4. æµ‹è¯•æˆåŠŸ/å¤±è´¥ â† ç»“æœå‡†ç¡®
```

**GitHub Actions ä»è¿œç¨‹ä»“åº“æ‹‰å–ä»£ç ï¼Œæœ¬åœ°ä¿®æ”¹ä¸ä¼šç”Ÿæ•ˆï¼**

## ğŸ”§ è°ƒè¯•å·¥å…·ä½¿ç”¨

### 1. Go è°ƒè¯•å·¥å…·ï¼ˆå¼ºçƒˆæ¨èï¼ï¼‰

**å·¥å…·**: `gh-action-debug` - ç”¨ Go ç¼–å†™çš„ GitHub Actions è°ƒè¯•å·¥å…·ï¼Œä¸“ä¸º AI è®¾è®¡

**ä½ç½®**: å®‰è£…åä½äºç³»ç»Ÿ PATH æˆ– `core/tools/go/dist/gh-action-debug`

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- âœ… **ä¸€ä¸ªå‘½ä»¤å®Œæˆæ‰€æœ‰æ­¥éª¤**ï¼šè§¦å‘ + ç›‘æ§ + åˆ†æ + å»ºè®®
- âœ… **æ ‡å‡† JSON è¾“å‡º**ï¼šAI å‹å¥½ï¼Œæ˜“äºè§£æ
- âœ… **æ™ºèƒ½é”™è¯¯åˆ†æ**ï¼š12+ ç§å¸¸è§é”™è¯¯æ¨¡å¼ï¼Œè‡ªåŠ¨ç”Ÿæˆä¿®å¤å»ºè®®
- âœ… **é›¶ä¾èµ–**ï¼šå•ä¸€å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ— éœ€ Python

**åŸºæœ¬ç”¨æ³•**ï¼š

```bash
# å®Œæ•´çš„è‡ªåŠ¨è°ƒè¯•ï¼ˆæ¨èï¼‰
gh-action-debug workflow debug .github/workflows/build.yml main --output json

# å¸¦å‚æ•°è§¦å‘
gh-action-debug workflow debug .github/workflows/release.yml main \
  --input version=1.0.0 \
  --output json

# è¯¦ç»†è¾“å‡ºï¼ˆè°ƒè¯•æ¨¡å¼ï¼‰
gh-action-debug workflow debug .github/workflows/build.yml main --verbose
```

**è¾“å‡ºç¤ºä¾‹ï¼ˆJSONï¼‰**ï¼š

```json
{
  "success": false,
  "run_id": 123456789,
  "run_url": "https://github.com/...",
  "status": "failure",
  "duration": 45,
  "errors": [
    {
      "job": "build",
      "step": "Install dependencies",
      "error_type": "missing_dependency",
      "message": "Cannot find module 'express'",
      "suggestions": [
        "Add 'express' to package.json dependencies",
        "Run: npm install express --save"
      ]
    }
  ],
  "suggestions": [
    "Add 'express' to package.json",
    "Run: npm install express --save"
  ]
}
```

**AI å·¥ä½œæµ**ï¼š
1. æ¨é€ä»£ç åˆ°è¿œç¨‹ä»“åº“
2. è¿è¡Œ `gh-action-debug workflow debug ... --output json`
3. è§£æ JSON è¾“å‡ºä¸­çš„ `errors` å’Œ `suggestions`
4. åº”ç”¨å»ºè®®è‡ªåŠ¨ä¿®å¤
5. æ¨é€ä¿®å¤åçš„ä»£ç 
6. é‡æ–°è¿è¡ŒéªŒè¯ï¼Œç›´åˆ° `success: true`

### 2. åˆ—å‡ºå·¥ä½œæµ

**åŠŸèƒ½**ï¼šæŸ¥çœ‹ä»“åº“ä¸­çš„æ‰€æœ‰å·¥ä½œæµ

**ç”¨æ³•**ï¼š

```bash
# åˆ—å‡ºæ‰€æœ‰å·¥ä½œæµ
gh-action-debug workflow list

# è¾“å‡ºç¤ºä¾‹ï¼š
# ğŸ“‹ å·¥ä½œæµåˆ—è¡¨:
#   - .github/workflows/build.yml (ID: 123456)
#   - .github/workflows/test.yml (ID: 123457)
#   - .github/workflows/release.yml (ID: 123458)
```

### 3. è§¦å‘å·¥ä½œæµï¼ˆä¸ç›‘æ§ï¼‰

**åŠŸèƒ½**ï¼šä»…è§¦å‘å·¥ä½œæµï¼Œä¸ç­‰å¾…ç»“æœ

**ç”¨æ³•**ï¼š

```bash
# è§¦å‘å·¥ä½œæµ
gh-action-debug workflow trigger .github/workflows/build.yml main

# å¸¦å‚æ•°è§¦å‘
gh-action-debug workflow trigger .github/workflows/release.yml main \
  --input version=1.0.0 \
  --input prerelease=false
```

### 4. æ‰¹é‡æµ‹è¯•å·¥ä½œæµ

**åŠŸèƒ½**ï¼šæµ‹è¯•å¤šä¸ªå·¥ä½œæµ

**ç”¨æ³•**ï¼š

```bash
# æµ‹è¯•æ‰€æœ‰å·¥ä½œæµ
npm run test-pipeline -- --all --trigger --watch

# æµ‹è¯•æŒ‡å®šçš„å·¥ä½œæµ
npm run test-pipeline -- --workflow build.yml --trigger

# ä»…éªŒè¯ YAML è¯­æ³•
npm run test-pipeline -- --all --verify
```

### 3. GitHub CLI ç›´æ¥è°ƒè¯•ï¼ˆä¸æ¨èï¼‰

**ä»…åœ¨å·¥å…·è„šæœ¬ä¸å¯ç”¨æ—¶ä½¿ç”¨**ï¼š

```bash
# æŸ¥çœ‹å·¥ä½œæµåˆ—è¡¨
gh workflow list

# æ‰‹åŠ¨è§¦å‘å·¥ä½œæµ
gh workflow run build.yml --ref main

# æŸ¥çœ‹æœ€è¿‘çš„è¿è¡Œ
gh run list --workflow=build.yml --limit 5

# æŸ¥çœ‹è¿è¡Œè¯¦æƒ…
gh run view <run-id>

# æŸ¥çœ‹å¤±è´¥æ—¥å¿—
gh run view <run-id> --log-failed
```

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### 1. æƒé™é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Error: Resource not accessible by integration
```

**åŸå› **ï¼šå·¥ä½œæµæƒé™ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**ï¼š

```yaml
# åœ¨å·¥ä½œæµæ–‡ä»¶ä¸­æ·»åŠ æƒé™
permissions:
  contents: write  # æˆ–æ ¹æ®éœ€è¦è°ƒæ•´
  issues: write
  pull-requests: write
```

### 2. Token æ— æ•ˆ

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Error: The token provided is invalid
```

**åŸå› **ï¼š`GITHUB_TOKEN` æœªæ­£ç¡®é…ç½®

**è§£å†³æ–¹æ¡ˆ**ï¼š

```yaml
# âœ… æ­£ç¡®ï¼šä½¿ç”¨é»˜è®¤ Token
env:
  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

# âŒ é”™è¯¯ï¼šToken åç§°é”™è¯¯
env:
  GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}  # åº”è¯¥æ˜¯ GITHUB_TOKEN
```

**æ³¨æ„**ï¼š`GITHUB_TOKEN` æ˜¯ GitHub Actions è‡ªåŠ¨æä¾›çš„ï¼Œä¸éœ€è¦æ‰‹åŠ¨åˆ›å»ºã€‚

### 3. ä¾èµ–å®‰è£…å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š
```
npm ERR! Cannot find module 'xxx'
```

**åŸå› **ï¼šä¾èµ–æœªæ­£ç¡®å®‰è£…æˆ–ç¼“å­˜é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š

```yaml
# æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°å®‰è£…
- name: Clear npm cache
  run: npm cache clean --force

- name: Install dependencies
  run: npm ci  # ä½¿ç”¨ ci è€Œä¸æ˜¯ install

# æˆ–è€…ç¦ç”¨ç¼“å­˜
- name: Setup Node.js
  uses: actions/setup-node@v4
  with:
    node-version: '18'
    # æš‚æ—¶ä¸ä½¿ç”¨ç¼“å­˜
```

### 4. è·¯å¾„é—®é¢˜

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Error: ENOENT: no such file or directory
```

**åŸå› **ï¼šæ–‡ä»¶è·¯å¾„ä¸æ­£ç¡®æˆ–æ–‡ä»¶ä¸å­˜åœ¨

**è§£å†³æ–¹æ¡ˆ**ï¼š

```yaml
# è°ƒè¯•ï¼šåˆ—å‡ºæ–‡ä»¶
- name: Debug - List files
  run: |
    pwd
    ls -la
    ls -la dist/

# ä½¿ç”¨æ­£ç¡®çš„è·¯å¾„
- name: Upload artifact
  uses: actions/upload-artifact@v4
  with:
    name: build-output
    path: dist/  # ç¡®è®¤è·¯å¾„æ­£ç¡®
    if-no-files-found: error  # æ‰¾ä¸åˆ°æ–‡ä»¶æ—¶æŠ¥é”™
```

### 5. ç¯å¢ƒå˜é‡æœªå®šä¹‰

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Error: Environment variable 'XXX' is not set
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```yaml
# åœ¨å·¥ä½œæµæˆ–æ­¥éª¤ä¸­å®šä¹‰
env:
  XXX: value

# æˆ–ä½¿ç”¨é»˜è®¤å€¼
run: |
  VALUE=${XXX:-default_value}
  echo "Value: $VALUE"
```

## ğŸ“Š æ—¥å¿—åˆ†ææŠ€å·§

### 1. å¯ç”¨è¯¦ç»†æ—¥å¿—

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Run with verbose logging
        run: |
          set -x  # Bash: æ˜¾ç¤ºæ‰§è¡Œçš„å‘½ä»¤
          npm run build --verbose
```

### 2. æ·»åŠ è°ƒè¯•è¾“å‡º

```yaml
- name: Debug info
  run: |
    echo "Node version: $(node --version)"
    echo "NPM version: $(npm --version)"
    echo "Current directory: $(pwd)"
    echo "Files: $(ls -la)"
    echo "Environment variables:"
    env | sort
```

### 3. ä½¿ç”¨ tmate è¿œç¨‹è°ƒè¯•ï¼ˆé«˜çº§ï¼‰

```yaml
# ä»…åœ¨å¤±è´¥æ—¶å¯åŠ¨ SSH è°ƒè¯•ä¼šè¯
- name: Setup tmate session
  if: failure()
  uses: mxschmitt/action-tmate@v3
  timeout-minutes: 30
```

## ğŸš« ç¦æ­¢çš„è°ƒè¯•æ–¹å¼

1. **âŒ æ‰‹åŠ¨è¿è¡Œå¤æ‚å‘½ä»¤**
   ```bash
   # ç¦æ­¢è¿™æ ·åš
   gh workflow run build.yml && sleep 10 && gh run list
   ```

2. **âŒ çŒœæµ‹é”™è¯¯åŸå› **
   ```
   ç¦æ­¢ï¼šçœ‹åˆ°å¤±è´¥å°±çŒœæµ‹åŸå› å¹¶ä¿®æ”¹ä»£ç 
   æ­£ç¡®ï¼šä½¿ç”¨å·¥å…·æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼Œç¡®è®¤é”™è¯¯åå†ä¿®æ”¹
   ```

3. **âŒ ä¸æ¨é€ä»£ç å°±æµ‹è¯•**
   ```bash
   # ç¦æ­¢è¿™æ ·åš
   vim .github/workflows/build.yml
   npm run ai-debug -- .github/workflows/build.yml main  # ä»£ç æœªæ¨é€ï¼
   ```

4. **âŒ ä¿®æ”¹åä¸éªŒè¯**
   ```
   ç¦æ­¢ï¼šä¿®æ”¹ä»£ç åè®¤ä¸ºé—®é¢˜å·²è§£å†³ï¼Œä¸è¿›è¡Œæµ‹è¯•
   æ­£ç¡®ï¼šæ¯æ¬¡ä¿®æ”¹åéƒ½è¦æ¨é€å¹¶è§¦å‘æµ‹è¯•éªŒè¯
   ```

## âœ… æœ€ä½³å®è·µ

1. **ä½¿ç”¨å·¥å…·è„šæœ¬**: ä¼˜å…ˆä½¿ç”¨ `npm run ai-debug` æˆ– `npm run test-pipeline`
2. **æŸ¥çœ‹å®Œæ•´æ—¥å¿—**: ä¸è¦åªçœ‹æ‘˜è¦ï¼ŒæŸ¥çœ‹å¤±è´¥æ­¥éª¤çš„å®Œæ•´è¾“å‡º
3. **é€æ­¥ä¿®å¤**: ä¸€æ¬¡åªä¿®å¤ä¸€ä¸ªé—®é¢˜ï¼Œä¿®å¤åç«‹å³éªŒè¯
4. **ä¿ç•™è°ƒè¯•ä»£ç **: å¤±è´¥çš„è°ƒè¯•æ­¥éª¤å¯ä»¥æš‚æ—¶ä¿ç•™ï¼ŒæˆåŠŸåå†åˆ é™¤
5. **è®°å½•è§£å†³æ–¹æ¡ˆ**: é‡åˆ°æ–°é—®é¢˜è§£å†³åï¼Œæ›´æ–°æ–‡æ¡£è®°å½•

## ğŸ¯ AI åŠ©æ‰‹è¡Œä¸ºè¦æ±‚

å½“éœ€è¦è°ƒè¯• GitHub Actions æ—¶ï¼š

1. âœ… **å¿…é¡»ä½¿ç”¨** `npm run ai-debug` æˆ–å¯¹åº”çš„å·¥å…·è„šæœ¬
2. âœ… **å¿…é¡»å…ˆæ¨é€ä»£ç **åˆ°è¿œç¨‹ä»“åº“
3. âœ… **å¿…é¡»æŸ¥çœ‹æ—¥å¿—**ï¼Œä¸èƒ½çŒœæµ‹é”™è¯¯
4. âœ… **å¿…é¡»éªŒè¯ä¿®å¤**ï¼Œç¡®ä¿é—®é¢˜çœŸæ­£è§£å†³
5. âŒ **ä¸¥æ ¼ç¦æ­¢**æ‰‹åŠ¨è¿è¡Œ `gh workflow run` å‘½ä»¤
6. âŒ **ä¸¥æ ¼ç¦æ­¢**ä¸æ¨é€ä»£ç å°±è§¦å‘æµ‹è¯•
7. âŒ **ä¸¥æ ¼ç¦æ­¢**ä¿®æ”¹åä¸éªŒè¯å°±è®¤ä¸ºé—®é¢˜å·²è§£å†³
