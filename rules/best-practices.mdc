---
alwaysApply: true
---

# GitHub Actions æœ€ä½³å®è·µ

## ğŸ¯ æ ¸å¿ƒç†å¿µ

1. **ä¿æŒç®€å•**: ä¼˜å…ˆä½¿ç”¨ç®€å•çš„ YAML é…ç½®ï¼Œé¿å…è¿‡åº¦æŠ½è±¡
2. **æœ¬åœ°ä¼˜å…ˆ**: æœ¬åœ°èƒ½æ„å»ºçš„ï¼ŒCI æ‰èƒ½æ„å»º
3. **å¿«é€Ÿåé¦ˆ**: ä¼˜åŒ–æ„å»ºé€Ÿåº¦ï¼Œä½¿ç”¨ç¼“å­˜å’Œå¹¶è¡Œ
4. **å¯ç»´æŠ¤æ€§**: æ¸…æ™°çš„ç»“æ„ï¼Œå……åˆ†çš„æ³¨é‡Šï¼Œæ˜“äºç†è§£

## ğŸ“‹ å·¥ä½œæµç»„ç»‡

### æ–‡ä»¶å‘½å

```
.github/workflows/
â”œâ”€â”€ build.yml           # æ„å»ºå·¥ä½œæµ
â”œâ”€â”€ test.yml            # æµ‹è¯•å·¥ä½œæµ
â”œâ”€â”€ release.yml         # å‘å¸ƒå·¥ä½œæµ
â”œâ”€â”€ ci.yml              # å®Œæ•´ CI æµç¨‹
â””â”€â”€ deploy-prod.yml     # ç”Ÿäº§éƒ¨ç½²
```

**å‘½åè§„èŒƒ**ï¼š
- ä½¿ç”¨å°å†™å­—æ¯å’Œè¿å­—ç¬¦
- åç§°åº”æ¸…æ™°æè¿°ç”¨é€”
- é¿å…è¿‡é•¿çš„åç§°

### å·¥ä½œæµæ‹†åˆ†

```yaml
# âŒ é¿å…ï¼šå•ä¸ªå·¨å¤§çš„å·¥ä½œæµ
# .github/workflows/everything.yml (500+ è¡Œ)

# âœ… æ¨èï¼šæ‹†åˆ†ä¸ºå¤šä¸ªå°å·¥ä½œæµ
# .github/workflows/build.yml (50 è¡Œ)
# .github/workflows/test.yml (50 è¡Œ)
# .github/workflows/deploy.yml (50 è¡Œ)
```

**æ‹†åˆ†åŸåˆ™**ï¼š
- æŒ‰åŠŸèƒ½æ‹†åˆ†ï¼ˆæ„å»ºã€æµ‹è¯•ã€éƒ¨ç½²ï¼‰
- å•ä¸ªæ–‡ä»¶ä¸è¶…è¿‡ 200 è¡Œ
- å¯ç‹¬ç«‹è§¦å‘å’Œè°ƒè¯•

### å·¥ä½œæµå¤ç”¨

```yaml
# .github/workflows/reusable-build.yml
name: Reusable Build Workflow

on:
  workflow_call:
    inputs:
      node-version:
        required: true
        type: string
    outputs:
      artifact-name:
        description: "Build artifact name"
        value: ${{ jobs.build.outputs.artifact-name }}

jobs:
  build:
    runs-on: ubuntu-latest
    outputs:
      artifact-name: ${{ steps.build.outputs.name }}
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ inputs.node-version }}
      # ... æ„å»ºæ­¥éª¤
```

```yaml
# .github/workflows/ci.yml
name: CI

on: [push, pull_request]

jobs:
  build:
    uses: ./.github/workflows/reusable-build.yml
    with:
      node-version: '18'
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### 1. ä½¿ç”¨ç¼“å­˜

```yaml
# Node.js é¡¹ç›®
- name: Setup Node.js
  uses: actions/setup-node@v4
  with:
    node-version: '18'
    cache: 'npm'  # è‡ªåŠ¨ç¼“å­˜

# Python é¡¹ç›®
- name: Setup Python
  uses: actions/setup-python@v5
  with:
    python-version: '3.11'
    cache: 'pip'

# è‡ªå®šä¹‰ç¼“å­˜
- name: Cache build output
  uses: actions/cache@v3
  with:
    path: |
      dist/
      .cache/
    key: ${{ runner.os }}-build-${{ hashFiles('src/**') }}
    restore-keys: |
      ${{ runner.os }}-build-
```

### 2. å¹¶è¡Œæ‰§è¡Œ

```yaml
jobs:
  test:
    strategy:
      matrix:
        platform: [ubuntu-latest, windows-latest, macos-latest]
        node: [16, 18, 20]
      fail-fast: false  # ä¸å› å•ä¸ªå¤±è´¥åœæ­¢æ‰€æœ‰ä»»åŠ¡
      max-parallel: 6   # é™åˆ¶å¹¶è¡Œæ•°
```

### 3. æ¡ä»¶æ‰§è¡Œ

```yaml
jobs:
  build:
    # åªåœ¨ä¸»åˆ†æ”¯æˆ–æ ‡ç­¾æ—¶æ‰§è¡Œ
    if: github.ref == 'refs/heads/main' || startsWith(github.ref, 'refs/tags/')
    steps:
      - name: Deploy
        # åªåœ¨ push äº‹ä»¶æ—¶æ‰§è¡Œ
        if: github.event_name == 'push'
        run: npm run deploy
      
      - name: Upload artifact
        # åªåœ¨ Linux ä¸Šæ‰§è¡Œ
        if: runner.os == 'Linux'
        uses: actions/upload-artifact@v4
```

### 4. è·³è¿‡ä¸å¿…è¦çš„è¿è¡Œ

```yaml
on:
  push:
    branches: [main]
    paths:
      - 'src/**'          # åªåœ¨ä»£ç å˜æ›´æ—¶è§¦å‘
      - 'package.json'
      - '.github/workflows/build.yml'
    paths-ignore:
      - 'docs/**'         # æ–‡æ¡£å˜æ›´ä¸è§¦å‘
      - '**.md'
```

## ğŸ” å®‰å…¨å®è·µ

### 1. æœ€å°æƒé™åŸåˆ™

```yaml
# âœ… æ¨èï¼šæ˜ç¡®æŒ‡å®šéœ€è¦çš„æƒé™
permissions:
  contents: read
  issues: write

# âŒ é¿å…ï¼šæˆäºˆæ‰€æœ‰æƒé™
permissions: write-all
```

### 2. å®‰å…¨ä½¿ç”¨ Secrets

```yaml
# âœ… æ­£ç¡®ï¼šåœ¨éœ€è¦æ—¶ä½¿ç”¨
- name: Deploy
  env:
    DEPLOY_TOKEN: ${{ secrets.DEPLOY_TOKEN }}
  run: |
    # ä¸è¦åœ¨æ—¥å¿—ä¸­æ‰“å° token
    deploy.sh

# âŒ é”™è¯¯ï¼šæš´éœ²åœ¨æ—¥å¿—ä¸­
- name: Debug
  run: echo "Token: ${{ secrets.DEPLOY_TOKEN }}"  # å±é™©ï¼
```

### 3. å›ºå®š Action ç‰ˆæœ¬

```yaml
# âœ… æ¨èï¼šä½¿ç”¨å…·ä½“ç‰ˆæœ¬
- uses: actions/checkout@v4
- uses: actions/setup-node@v4.0.0

# âŒ é¿å…ï¼šä½¿ç”¨ latest æˆ–åˆ†æ”¯
- uses: actions/checkout@latest
- uses: actions/setup-node@main
```

### 4. å®¡æŸ¥ç¬¬ä¸‰æ–¹ Actions

```yaml
# âœ… æ¨èï¼šä½¿ç”¨å¯ä¿¡çš„å®˜æ–¹ Actions
- uses: actions/checkout@v4
- uses: actions/setup-node@v4

# âš ï¸ è°¨æ…ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹ Actions
- uses: some-user/unknown-action@v1  # å…ˆå®¡æŸ¥ä»£ç 
```

## ğŸ“Š æ—¥å¿—å’Œè°ƒè¯•

### 1. ç»“æ„åŒ–æ—¥å¿—

```yaml
- name: Build application
  run: |
    echo "::group::Installing dependencies"
    npm install
    echo "::endgroup::"
    
    echo "::group::Building application"
    npm run build
    echo "::endgroup::"
    
    echo "::notice::Build completed successfully"
```

### 2. è¾“å‡ºé‡è¦ä¿¡æ¯

```yaml
- name: Build info
  id: build
  run: |
    VERSION=$(node -p "require('./package.json').version")
    echo "version=$VERSION" >> $GITHUB_OUTPUT
    echo "::notice::Building version $VERSION"

- name: Use build info
  run: echo "Version: ${{ steps.build.outputs.version }}"
```

### 3. é”™è¯¯å¤„ç†

```yaml
- name: Run tests
  run: |
    if ! npm test; then
      echo "::error::Tests failed"
      exit 1
    fi
    echo "::notice::All tests passed"
```

## ğŸ”„ æœ¬åœ°ä¸ CI ä¸€è‡´æ€§

### åŸåˆ™ï¼šæœ¬åœ°èƒ½æ„å»ºï¼ŒCI æ‰èƒ½æ„å»º

```bash
# åˆ›å»ºæœ¬åœ°æ„å»ºè„šæœ¬
# scripts/build.sh

#!/bin/bash
set -e

echo "Installing dependencies..."
npm install

echo "Running linter..."
npm run lint

echo "Running tests..."
npm test

echo "Building..."
npm run build

echo "âœ… Build completed"
```

```yaml
# GitHub Actions ä½¿ç”¨ç›¸åŒçš„è„šæœ¬
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
      
      # ä½¿ç”¨æœ¬åœ°ç›¸åŒçš„æ„å»ºè„šæœ¬
      - name: Build
        run: bash scripts/build.sh
```

**ä¼˜åŠ¿**ï¼š
- æœ¬åœ°è°ƒè¯•æ›´å¿«
- CI å’Œæœ¬åœ°ç»“æœä¸€è‡´
- è„šæœ¬å¯åœ¨å¤šä¸ª CI ç³»ç»Ÿå¤ç”¨

## ğŸ“ æ–‡æ¡£å’Œæ³¨é‡Š

### 1. å·¥ä½œæµæ–‡æ¡£

```yaml
name: Build and Test

# è¯´æ˜ï¼šæ„å»ºåº”ç”¨å¹¶è¿è¡Œæµ‹è¯•
# è§¦å‘ï¼špush åˆ° main åˆ†æ”¯æˆ–åˆ›å»º PR
# è¾“å‡ºï¼šæ„å»ºäº§ç‰©ä¸Šä¼ åˆ° artifacts

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # æ£€å‡ºä»£ç ï¼ˆåŒ…å«å®Œæ•´å†å²ç”¨äºç‰ˆæœ¬å·ï¼‰
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
```

### 2. æ­¥éª¤æ³¨é‡Š

```yaml
steps:
  # è®¾ç½® Node.js ç¯å¢ƒ
  # ä½¿ç”¨ v18 LTS ç‰ˆæœ¬ï¼Œä¸æœ¬åœ°å¼€å‘ç¯å¢ƒä¸€è‡´
  - name: Setup Node.js
    uses: actions/setup-node@v4
    with:
      node-version: '18'
      cache: 'npm'
  
  # å®‰è£…ä¾èµ–
  # ä½¿ç”¨ npm ci è€Œä¸æ˜¯ npm install ç¡®ä¿é”æ–‡ä»¶ä¸€è‡´æ€§
  - name: Install dependencies
    run: npm ci
```

## ğŸ¨ ä»£ç é£æ ¼

### YAML æ ¼å¼

```yaml
# âœ… æ¨èï¼šæ¸…æ™°çš„ç¼©è¿›å’Œç©ºè¡Œ
name: CI

on:
  push:
    branches: [main]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Build
        run: npm run build

# âŒ é¿å…ï¼šæ··ä¹±çš„æ ¼å¼
name: CI
on: {push: {branches: [main]}}
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    - name: Build
      run: npm run build
```

### ç¯å¢ƒå˜é‡å‘½å

```yaml
env:
  # âœ… æ¨èï¼šå¤§å†™å­—æ¯å’Œä¸‹åˆ’çº¿
  NODE_VERSION: '18'
  BUILD_ENV: production
  API_BASE_URL: https://api.example.com
  
  # âŒ é¿å…ï¼šå°å†™æˆ–æ··åˆ
  nodeVersion: '18'
  buildEnv: production
```

## ğŸš€ æŒç»­æ”¹è¿›

### 1. ç›‘æ§å·¥ä½œæµæ€§èƒ½

```yaml
- name: Build with timing
  run: |
    START_TIME=$(date +%s)
    npm run build
    END_TIME=$(date +%s)
    DURATION=$((END_TIME - START_TIME))
    echo "::notice::Build completed in ${DURATION}s"
```

### 2. å®šæœŸå®¡æŸ¥å’Œä¼˜åŒ–

- æ¯æœˆå®¡æŸ¥å·¥ä½œæµæ‰§è¡Œæ—¶é—´
- è¯†åˆ«æ…¢çš„æ­¥éª¤å¹¶ä¼˜åŒ–
- åˆ é™¤ä¸å†ä½¿ç”¨çš„å·¥ä½œæµ
- æ›´æ–°è¿‡æ—¶çš„ Actions

### 3. ä½¿ç”¨ Actions ä¾èµ–å›¾

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    # ...
  
  test:
    needs: build  # ç­‰å¾… build å®Œæˆ
    runs-on: ubuntu-latest
    # ...
  
  deploy:
    needs: [build, test]  # ç­‰å¾…å¤šä¸ªä»»åŠ¡
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    # ...
```

## ğŸ¯ AI åŠ©æ‰‹è¡Œä¸ºæŒ‡å—

å½“å¤„ç† GitHub Actions æ—¶ï¼š

1. **éµå¾ªè§„åˆ™**: æŒ‰ç…§è§„åˆ™å’Œæœ€ä½³å®è·µåˆ›å»ºå·¥ä½œæµ
2. **ä¿æŒç®€å•**: ä¸è¦è¿‡åº¦å·¥ç¨‹åŒ–ï¼ŒYAML é…ç½®åº”ç®€æ´æ˜äº†
3. **æœ¬åœ°æµ‹è¯•**: æ„å»ºè„šæœ¬åº”è¯¥èƒ½åœ¨æœ¬åœ°è¿è¡Œï¼Œä¸ä¾èµ– CI ç¯å¢ƒ
4. **ä½¿ç”¨å·¥å…·**: è°ƒè¯•æ—¶ä½¿ç”¨é¡¹ç›®æä¾›çš„è„šæœ¬ï¼Œä¸è¦æ‰‹åŠ¨æ“ä½œ
5. **æ–‡æ¡£åŒæ­¥**: ä¿®æ”¹å·¥ä½œæµæ—¶æ›´æ–°ç›¸å…³æ–‡æ¡£
6. **éªŒè¯ä¿®æ”¹**: æ¯æ¬¡ä¿®æ”¹åéƒ½è¦æµ‹è¯•éªŒè¯
7. **å®‰å…¨ç¬¬ä¸€**: æ³¨æ„æƒé™å’Œå¯†é’¥çš„ä½¿ç”¨

## ğŸ“š å‚è€ƒèµ„æº

- [GitHub Actions å®˜æ–¹æ–‡æ¡£](https://docs.github.com/en/actions)
- [GitHub Actions Marketplace](https://github.com/marketplace?type=actions)
- [å·¥ä½œæµè¯­æ³•](https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions)
